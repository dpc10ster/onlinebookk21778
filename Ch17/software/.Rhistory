# mainRsmPlots.R
rm(list = ls())
library(RJafroc)
K2 <- 700;Lmax <- 1;Lk2 <- floor(runif(K2, 1, Lmax + 1))
nLesPerCase <- unique(Lk2);lesionDist <- array(dim = c(length(nLesPerCase), 2))
nLesPerCase
lesionDist
nLesPerCase <- unique(Lk2);lesionDist <- array(dim = c(length(nLesPerCase), 2))
for (i in nLesPerCase) lesionDist[i, ] <- c(i, sum(Lk2 == i)/K2)
lesionDist
source('~/onlinebookk21778/Ch17/software/mainRsmPlots.R')
lesionDist
debugSource('~/onlinebookk21778/Ch17/software/mainRsmPlots.R')
lesionDist
debugSource('~/onlinebookk21778/Ch17/software/mainRsmPlots.R')
source('~/onlinebookk21778/Ch17/software/mainRsmPlots.R')
source('~/onlinebookk21778/Ch17/software/mainRsmPdfRoc.R')
source('~/onlinebookk21778/Ch17/software/mainIsFrocGood.R')
source('~/onlinebookk21778/Ch17/software/mainRsmVsRocfitR.R')
RowString
source('~/onlinebookk21778/Ch17/software/mainRsmVsRocfitR.R')
nBins
compPlot$compPlot
source('~/onlinebookk21778/Ch17/software/mainRsmVsRocfitR.R')
debugSource('~/onlinebookk21778/Ch17/software/mainRsmVsRocfitR.R')
rocDataTable
retRocfit
aucs
debugSource('~/onlinebookk21778/Ch17/software/MainRsmVsEng.R')
rocDataTable
debugSource('~/onlinebookk21778/Ch17/software/MainRsmVsEng.R')
rocDataTable
debugSource('~/onlinebookk21778/Ch17/software/MainRsmVsEng.R')
rocDataTable
debugSource('~/onlinebookk21778/Ch17/software/MainRsmVsEng.R')
source('~/onlinebookk21778/Ch17/software/MainRsmVsEng.R')
debugSource('~/onlinebookk21778/Ch17/software/MainRsmVsEng.R')
source('~/onlinebookk21778/Ch17/software/MainRsmVsEng.R')
debugSource('~/onlinebookk21778/Ch17/software/MainRsmVsEng.R')
aucs <- UtilAucsRSM(mu, lambdaP, nuP, Lk2)
Lk2
aucs <- UtilAucsRSM(mu, lambdaP, nuP, lesionDist)
source('~/onlinebookk21778/Ch17/software/MainRsmVsEng.R')
debugSource('~/onlinebookk21778/Ch17/software/MainRsmVsEng.R')
source('~/onlinebookk21778/Ch17/software/MainRsmVsEng.R')
K2 <- 700;Lmax <- 4;Lk2 <- floor(runif(K2, 1, Lmax + 1))
nLesPerCase <- unique(Lk2);lesionDist <- array(dim = c(length(nLesPerCase), 2))
for (i in nLesPerCase) lesionDist[i, ] <- c(i, sum(Lk2 == i)/K2)
lesionDist
K2
K2 <- 70;Lmax <- 4;Lk2 <- floor(runif(K2, 1, Lmax + 1))
nLesPerCase <- unique(Lk2);lesionDist <- array(dim = c(length(nLesPerCase), 2))
for (i in nLesPerCase) lesionDist[i, ] <- c(i, sum(Lk2 == i)/K2)
lesionDist
K2
K2 <- 7;Lmax <- 4;Lk2 <- floor(runif(K2, 1, Lmax + 1))
nLesPerCase <- unique(Lk2);lesionDist <- array(dim = c(length(nLesPerCase), 2))
for (i in nLesPerCase) lesionDist[i, ] <- c(i, sum(Lk2 == i)/K2)
K2
K2 <- 7;Lmax <- 4;Lk2 <- floor(runif(K2, 1, Lmax + 1))
nLesPerCase <- unique(Lk2);lesionDist <- array(dim = c(length(nLesPerCase), 2))
nLesPerCase
for (i in nLesPerCase) lesionDist[i, ] <- c(i, sum(Lk2 == i)/K2)
lesionDist
K2
K2 <- 7;Lmax <- 4;Lk2 <- floor(runif(K2, 1, Lmax + 1))
nLesPerCase <- unique(Lk2);lesionDist <- array(dim = c(length(nLesPerCase), 2))
for (i in nLesPerCase) lesionDist[i, ] <- c(i, sum(Lk2 == i)/K2)
K2 <- 7;Lmax <- 4;Lk2 <- floor(runif(K2, 1, Lmax + 1))
nLesPerCase <- unique(Lk2);lesionDist <- array(dim = c(length(nLesPerCase), 2))
for (i in nLesPerCase) lesionDist[i, ] <- c(i, sum(Lk2 == i)/K2)
Lk2
nLesPerCase
K2 <- 7;Lmax <- 4;Lk2 <- floor(runif(K2, 1, Lmax + 1))
nLesPerCase <- unique(Lk2);lesionDist <- array(dim = c(length(nLesPerCase), 2))
for (i in nLesPerCase) lesionDist[i, ] <- c(i, sum(Lk2 == i)/K2)
nLesPerCase
source('~/onlinebookk21778/Ch17/software/mainRsmSwetsObservations.R')
# mainIsFrocGood.R
rm(list = ls())
library(RJafroc)
library(ggplot2)
logseq <- function( d1, d2, n) {
logf <- log(d2/d1)/(n-1)
return (exp(seq(log(d1), log(d2), logf)))
}
Lmax <- 1;K2 <- 700;Lk2 <- floor(runif(K2, 1, Lmax + 1))
nLesPerCase <- unique(Lk2)
lesionDist <- array(dim = c(length(nLesPerCase), 2))
for (i in nLesPerCase) lesionDist[i, ] <- c(i, sum(Lk2 == i)/K2)
## PART I
lambda <- 1;nu <- 1
cat("Vary mu only, lambda and nu equal to 1\n")
muArr <- logseq(0.001, 10, 9)
aucRoc <- rep(NA, length(muArr))
aucAfroc <- aucRoc;aucFroc <- aucRoc
for (i in 1:length(muArr)) { # vary mu loop
mu <- muArr[i]
ret1 <- PlotRsmOperatingCharacteristics(
mu, lambda, nu,
lesionDistribution = lesionDist,
llfRange = c(0,1)
)
cat("mu = ", mu,", lambda = ", lambda,
", nu = ", nu, ", aucFroc = ", ret1$aucFROC,
", aucRoc = ", ret1$aucROC,", aucAfroc = ", ret1$aucAFROC,"\n")
aucRoc[i] <- ret1$aucROC
aucAfroc[i] <- ret1$aucAFROC
aucFroc[i] <- ret1$aucFROC
}
debugSource('~/onlinebookk21778/Ch17/software/mainIsFrocGood.R')
muArr
muArr2
debugSource('~/onlinebookk21778/Ch17/software/mainIsFrocGood.R')
muArr2
debugSource('~/onlinebookk21778/Ch17/software/mainIsFrocGood.R')
ret1$aucwAFROC
ret1$aucAFROC
debugSource('~/onlinebookk21778/Ch17/software/mainIsFrocGood.R')
aucRoc
aucRoc2
muArr2
muArr
aucRoc
plot(aucAfroc, aucRoc)
debugSource('~/onlinebookk21778/Ch17/software/mainIsFrocGood.R')
lambdaArr2 <- seq(0.2, 8, by = 0.1)
aucRoc2 <- rep(NA, length(lambdaArr2))
aucAfroc2 <- aucRoc2;aucFroc2 <- aucRoc2
for (i in 1:length(lambdaArr2)) { # vary mu loop
mu <- 2;lambda <- lambdaArr2[i];nu <- 1
ret1 <- PlotRsmOperatingCharacteristics(
mu, lambda, nu,
lesionDistribution = lesionDist, type = "ROC"
)
aucRoc2[i] <- ret1$aucROC
ret1 <- PlotRsmOperatingCharacteristics(
mu, lambda, nu,
lesionDistribution = lesionDist, type = "AFROC"
)
aucAfroc2[i] <- ret1$aucAFROC
ret1 <- PlotRsmOperatingCharacteristics(
mu, lambda, nu,
lesionDistribution = lesionDist, type = "FROC",
llfRange = c(0,1)
)
aucFroc2[i] <- ret1$aucFROC
}
plotCurveRocFroc <- data.frame(
aucRoc = c(aucRoc, aucRoc2), aucFroc = c(aucFroc, aucFroc2))
plotRocFroc <- ggplot(
data = aucRocFroc, mapping = aes(x = aucRoc, y = aucFroc)) +
geom_point(size = 5) +
geom_line(data = plotCurveRocFroc, size = 2) +
xlab("ROC-AUC") + ylab("FROC-AUC") +
theme(axis.title.y = element_text(size = 25,face="bold"),
axis.title.x = element_text(size = 30,face="bold"))
print(plotRocFroc)
plotCurveRocAfroc <- data.frame(
aucRoc = c(aucRoc, aucRoc2), aucAfroc = c(aucAfroc, aucAfroc2))
plotRocAfroc <- ggplot(
data = aucRocAfroc, mapping = aes(x = aucRoc, y = aucAfroc)) +
geom_point(size = 5) +
geom_line(data = plotCurveRocAfroc, size = 2) +
xlab("ROC-AUC") + ylab("AFROC-AUC") +
theme(axis.title.y =
element_text(size = 25,face="bold"),
axis.title.x = element_text(size = 30,face="bold"))
print(plotRocAfroc)
source('~/onlinebookk21778/Ch17/software/mainIsFrocGood.R')
debugSource('~/onlinebookk21778/Ch17/software/mainIsFrocGood.R')
ret1$aucFROC
ret1 <- PlotRsmOperatingCharacteristics(
mu, lambda, nu,
lesionDistribution = lesionDist)
ret1$aucFROC
source('~/onlinebookk21778/Ch17/software/mainIsFrocGood.R')
(aucAfroc2[9]-aucAfroc2[1])/(aucRoc2[9]-aucRoc2[1])
debugSource('~/onlinebookk21778/Ch17/software/mainIsFrocGood.R')
(aucAfroc2[9]-aucAfroc2[1])/(aucRoc2[9]-aucRoc2[1])
source('~/onlinebookk21778/Ch17/software/mainIsFrocGood.R')
